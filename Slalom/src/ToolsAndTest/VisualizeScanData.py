

#   ____________________________________________
#   |                                          |
#   |  Technik Autonomer Systeme -TUM          |
#   |  Gruppe 09                               |
#   |                                          |
#   |  erstellt: WS 2014/2015 - (c) Tim Stahl  |
#   |__________________________________________|

import math
import numpy
import matplotlib.pyplot as plt
from tf.transformations import euler_from_quaternion

if __name__ == '__main__':

	# Parameters (insert scandata or manual scanpattern)
	pose_x = 24.044354766437703 
	pose_y = 17.460195422453413
	(a,b,pose_alpha) = euler_from_quaternion((0,0,-0.6172456030356905, 0.7867705291462732))
	
	increment = 0.004363
	angle_min = -1.570796
	ranges = (1.9889999628067017, 1.9919999837875366, 1.9930000305175781, 2.002000093460083, 2.003999948501587, 2.003999948501587, 2.013000011444092, 2.013000011444092, 2.0139999389648438, 2.015000104904175, 2.0209999084472656, 2.0269999504089355, 2.0309998989105225, 2.0329999923706055, 2.0369999408721924, 2.0420000553131104, 2.0450000762939453, 2.0460000038146973, 2.049999952316284, 2.0510001182556152, 2.055999994277954, 2.059000015258789, 2.062999963760376, 2.062999963760376, 2.065000057220459, 2.062999963760376, 2.062999963760376, 2.056999921798706, 2.046999931335449, 2.0250000953674316, 1.9789999723434448, 1.9739999771118164, 1.9509999752044678, 1.9320000410079956, 1.9259999990463257, 1.8930000066757202, 1.878999948501587, 1.8639999628067017, 1.8639999628067017, 1.8639999628067017, 1.8730000257492065, 1.8830000162124634, 1.8969999551773071, 1.9019999504089355, 1.906000018119812, 1.909000039100647, 1.9249999523162842, 1.9290000200271606, 1.9329999685287476, 1.937999963760376, 1.9429999589920044, 1.9470000267028809, 1.9490000009536743, 1.9500000476837158, 1.968000054359436, 1.968000054359436, 1.9769999980926514, 1.9769999980926514, 1.9869999885559082, 1.9889999628067017, 1.99399995803833, 1.9989999532699585, 2.003000020980835, 2.0160000324249268, 2.0190000534057617, 2.0280001163482666, 2.0309998989105225, 2.0329999923706055, 2.0409998893737793, 2.046999931335449, 2.046999931335449, 2.046999931335449, 0.777999997138977, 0.6209999918937683, 0.6140000224113464, 0.6029999852180481, 0.6000000238418579, 0.6000000238418579, 0.5989999771118164, 0.5989999771118164, 0.5989999771118164, 0.5989999771118164, 0.5989999771118164, 0.6029999852180481, 0.5979999899864197, 0.5979999899864197, 0.6000000238418579, 0.6050000190734863, 0.6000000238418579, 0.6000000238418579, 0.5989999771118164, 0.5989999771118164, 0.5989999771118164, 0.6060000061988831, 0.609000027179718, 0.609000027179718, 0.6110000014305115, 0.6150000095367432, 0.6110000014305115, 0.6119999885559082, 0.6179999709129333, 0.6179999709129333, 2.302000045776367, 2.303999900817871, 2.312000036239624, 2.3239998817443848, 2.3389999866485596, 2.3420000076293945, 2.3550000190734863, 2.3550000190734863, 2.372999906539917, 2.378999948501587, 2.3889999389648438, 2.3989999294281006, 2.4179999828338623, 2.428999900817871, 2.437000036239624, 2.4489998817443848, 2.4570000171661377, 2.4679999351501465, 2.496000051498413, 2.5, 2.50600004196167, 2.5269999504089355, 2.5299999713897705, 2.549999952316284, 2.556999921798706, 2.5769999027252197, 2.5899999141693115, 2.5980000495910645, 2.614000082015991, 2.61899995803833, 2.6410000324249268, 2.6470000743865967, 2.6619999408721924, 2.6760001182556152, 2.686000108718872, 2.7090001106262207, 2.7149999141693115, 2.7360000610351562, 2.75600004196167, 2.7730000019073486, 2.7909998893737793, 2.812000036239624, 2.8239998817443848, 2.8380000591278076, 2.8550000190734863, 2.878999948501587, 2.88100004196167, 2.9040000438690186, 2.930000066757202, 2.9560000896453857, 2.9730000495910645, 2.990000009536743, 3.0139999389648438, 3.0390000343322754, 3.055000066757202, 3.062000036239624, 3.0820000171661377, 3.0869998931884766, 3.125999927520752, 3.1429998874664307, 3.1619999408721924, 3.194000005722046, 3.2090001106262207, 3.2260000705718994, 3.2679998874664307, 3.2869999408721924, 3.315999984741211, 3.3340001106262207, 3.3580000400543213, 3.384999990463257, 3.4100000858306885, 3.440000057220459, 3.4719998836517334, 3.490999937057495, 3.5220000743865967, 3.5439999103546143, 3.568000078201294, 3.5980000495910645, 3.635999917984009, 3.6610000133514404, 3.687000036239624, 3.7190001010894775, 3.747999906539917, 3.7860000133514404, 3.8320000171661377, 3.878000020980835, 3.9010000228881836, 3.933000087738037, 3.9749999046325684, 4.019999980926514, 4.051000118255615, 4.077000141143799, 4.129000186920166, 4.1519999504089355, 4.179999828338623, 4.230000019073486, 4.269999980926514, 4.307000160217285, 4.369999885559082, 4.4019999504089355, 4.440000057220459, 4.506999969482422, 4.540999889373779, 4.604000091552734, 4.6620001792907715, 4.7129998207092285, 4.7829999923706055, 4.828000068664551, 4.900000095367432, 4.9629998207092285, 5.039000034332275, 5.105000019073486, 5.1539998054504395, 5.230999946594238, 5.284999847412109, 5.339000225067139, 5.392000198364258, 7.5970001220703125, 7.5970001220703125, 7.585000038146973, 7.583000183105469, 7.572999954223633, 7.563000202178955, 7.5329999923706055, 7.53000020980835, 7.5289998054504395, 7.513000011444092, 7.448999881744385, 2.124000072479248, 2.0980000495910645, 2.069999933242798, 2.069000005722046, 2.069000005722046, 2.069000005722046, 2.071000099182129, 2.0759999752044678, 2.1050000190734863, 2.1570000648498535, 7.735000133514404, 7.88100004196167, 8.053000450134277, 8.234000205993652, 8.40999984741211, 8.651000022888184, 8.800000190734863, 8.91100025177002, 9.147000312805176, 9.618000030517578, 9.88599967956543, 9.909000396728516, 9.925000190734863, 9.925000190734863, 9.907999992370605, 9.892000198364258, 9.890999794006348, 3.7039999961853027, 3.7009999752044678, 3.697000026702881, 3.697000026702881, 3.697000026702881, 3.752000093460083, 9.847000122070312, 9.847000122070312, 9.845000267028809, 9.845000267028809, 5.308000087738037, 5.293000221252441, 5.308000087738037, 5.348999977111816, 9.812999725341797, 9.817000389099121, 9.812999725341797, 9.807000160217285, 9.803000450134277, 9.802000045776367, 9.803000450134277, 9.814000129699707, 9.857999801635742, 9.902999877929688, 9.932000160217285, 12.279999732971191, 12.279999732971191, 12.267000198364258, 12.267000198364258, 12.276000022888184, 12.279000282287598, 12.282999992370605, 12.282999992370605, 12.277000427246094, 12.27299976348877, 12.258000373840332, 12.258000373840332, 12.27299976348877, 12.277999877929688, 12.277999877929688, 12.270999908447266, 12.187999725341797, 9.755999565124512, 9.460000038146973, 9.347000122070312, 9.347000122070312, 9.640999794006348, 9.644000053405762, 9.644000053405762, 8.315999984741211, 8.281000137329102, 5.045000076293945, 4.995999813079834, 4.813000202178955, 4.688000202178955, 4.663000106811523, 4.63700008392334, 4.635000228881836, 4.632999897003174, 4.623000144958496, 4.623000144958496, 4.620999813079834, 4.617000102996826, 4.610000133514404, 4.553999900817871, 4.545000076293945, 4.540999889373779, 4.538000106811523, 4.5370001792907715, 4.5, 3.936000108718872, 3.697000026702881, 3.6659998893737793, 3.6029999256134033, 3.5239999294281006, 3.434000015258789, 3.3450000286102295, 3.2639999389648438, 3.184999942779541, 3.121999979019165, 3.072999954223633, 3.003000020980835, 2.936000108718872, 2.874000072479248, 2.803999900817871, 2.759000062942505, 2.7160000801086426, 2.6679999828338623, 2.628000020980835, 2.5759999752044678, 2.5290000438690186, 2.484999895095825, 2.4560000896453857, 2.4070000648498535, 2.368000030517578, 2.3380000591278076, 2.302000045776367, 2.2639999389648438, 2.2249999046325684, 2.196000099182129, 2.1530001163482666, 2.138000011444092, 2.1040000915527344, 2.0799999237060547, 2.0439999103546143, 2.0179998874664307, 1.9989999532699585, 1.9730000495910645, 1.944000005722046, 1.9179999828338623, 1.8949999809265137, 1.86899995803833, 1.840999960899353, 1.8209999799728394, 1.7949999570846558, 1.774999976158142, 1.7580000162124634, 1.7389999628067017, 1.7209999561309814, 1.7020000219345093, 1.687000036239624, 1.6619999408721924, 1.6449999809265137, 1.6360000371932983, 1.6109999418258667, 1.5989999771118164, 1.5829999446868896, 1.559999942779541, 1.5479999780654907, 1.531000018119812, 1.5080000162124634, 1.503999948501587, 1.4930000305175781, 1.4609999656677246, 1.4470000267028809, 1.437999963760376, 1.4199999570846558, 1.4170000553131104, 1.406000018119812, 1.3880000114440918, 1.378999948501587, 1.371999979019165, 1.3519999980926514, 1.350000023841858, 1.3309999704360962, 1.3229999542236328, 1.315000057220459, 1.2949999570846558, 1.2790000438690186, 1.2790000438690186, 1.2719999551773071, 1.2589999437332153, 1.24399995803833, 1.2430000305175781, 1.2330000400543213, 1.2200000286102295, 1.2050000429153442, 1.2000000476837158, 1.190000057220459, 1.1829999685287476, 1.1799999475479126, 1.1649999618530273, 1.1640000343322754, 1.1480000019073486, 1.1419999599456787, 1.1390000581741333, 1.1369999647140503, 1.1200000047683716, 1.1119999885559082, 1.0989999771118164, 1.0989999771118164, 1.0989999771118164, 1.0959999561309814, 1.0920000076293945, 1.0759999752044678, 1.0670000314712524, 1.062999963760376, 1.062999963760376, 1.062999963760376, 1.0399999618530273, 1.0089999437332153, 0.9919999837875366, 0.9829999804496765, 0.9810000061988831, 0.9739999771118164, 0.9739999771118164, 0.9739999771118164, 0.968999981880188, 0.9739999771118164, 0.9769999980926514, 0.9800000190734863, 0.9890000224113464, 0.9890000224113464, 0.9890000224113464, 0.9909999966621399, 0.9919999837875366, 1.003000020980835, 1.003000020980835, 1.003999948501587, 1.00600004196167, 1.0089999437332153, 1.0110000371932983, 1.0130000114440918, 1.0230000019073486, 1.0260000228881836, 1.0299999713897705, 1.0399999618530273, 1.0410000085830688, 1.0410000085830688, 1.0529999732971191, 1.0609999895095825, 1.062000036239624, 1.062000036239624, 1.062000036239624, 1.0570000410079956, 1.0429999828338623, 1.034000039100647, 1.0269999504089355, 1.0269999504089355, 1.0199999809265137, 1.0169999599456787, 1.0169999599456787, 1.0110000371932983, 1.0, 0.9980000257492065, 0.9940000176429749, 0.9940000176429749, 0.9940000176429749, 0.9929999709129333, 0.9890000224113464, 0.984000027179718, 0.984000027179718, 0.9800000190734863, 0.9789999723434448, 0.972000002861023, 0.9700000286102295, 0.9670000076293945, 0.9639999866485596, 0.9620000123977661, 0.9610000252723694, 0.9459999799728394, 0.9390000104904175, 0.9390000104904175, 0.9330000281333923, 0.9330000281333923, 0.9330000281333923, 0.9309999942779541, 0.9309999942779541, 0.9259999990463257, 0.921999990940094, 0.9190000295639038, 0.9150000214576721, 0.9089999794960022, 0.9049999713897705, 0.9049999713897705, 0.9049999713897705, 0.9049999713897705, 0.902999997138977, 0.902999997138977, 0.9020000100135803, 0.8949999809265137, 0.890999972820282, 0.8840000033378601, 0.8820000290870667, 0.8809999823570251, 0.875, 0.8709999918937683, 0.8709999918937683, 0.8659999966621399, 0.8659999966621399, 0.8640000224113464, 0.8640000224113464, 0.8569999933242798, 0.8569999933242798, 0.8569999933242798, 0.8579999804496765, 0.8579999804496765, 0.8579999804496765, 0.8529999852180481, 0.8420000076293945, 0.8420000076293945, 0.8450000286102295, 0.8450000286102295, 0.8450000286102295, 0.8450000286102295, 0.843999981880188, 0.8309999704360962, 0.8299999833106995, 0.8299999833106995, 0.8299999833106995, 0.828000009059906, 0.8270000219345093, 0.8270000219345093, 0.8240000009536743, 0.8240000009536743, 0.8209999799728394, 0.8199999928474426, 0.8190000057220459, 0.8180000185966492, 0.8119999766349792, 0.8069999814033508, 0.8069999814033508, 0.8069999814033508, 0.8069999814033508, 0.8059999942779541, 0.8050000071525574, 0.8050000071525574, 0.7990000247955322, 0.7979999780654907, 0.7979999780654907, 0.796999990940094, 0.7950000166893005, 0.7979999780654907, 0.8019999861717224, 0.7950000166893005, 0.796999990940094, 0.8019999861717224, 0.796999990940094, 0.7950000166893005, 0.7950000166893005, 0.7950000166893005, 0.7910000085830688, 0.7940000295639038, 0.7910000085830688, 0.7860000133514404, 0.7850000262260437, 0.7860000133514404, 0.7829999923706055, 0.781000018119812, 0.7799999713897705, 0.7770000100135803, 0.7770000100135803, 0.7749999761581421, 0.7720000147819519, 0.7720000147819519, 0.7720000147819519, 0.7680000066757202, 0.7680000066757202, 0.7680000066757202, 0.7689999938011169, 0.7689999938011169, 0.7770000100135803, 0.7770000100135803, 0.7770000100135803, 0.7739999890327454, 0.765999972820282, 0.765999972820282, 0.7649999856948853, 0.7570000290870667, 0.7570000290870667, 0.7570000290870667, 0.7570000290870667, 0.7620000243186951, 0.7630000114440918, 0.7630000114440918, 0.7630000114440918, 0.7630000114440918, 0.7630000114440918, 0.7649999856948853, 0.7649999856948853, 0.7599999904632568, 0.7570000290870667, 0.7559999823570251, 0.7549999952316284, 0.7549999952316284, 0.7559999823570251, 0.7559999823570251, 0.7570000290870667, 0.7570000290870667, 0.7559999823570251, 0.7570000290870667, 0.7570000290870667, 0.7570000290870667, 0.7580000162124634, 0.7620000243186951, 0.7620000243186951, 0.7609999775886536, 0.7609999775886536, 0.7559999823570251, 0.7540000081062317, 0.7540000081062317, 0.7559999823570251, 0.7540000081062317, 0.753000020980835, 0.753000020980835, 0.7509999871253967, 0.7480000257492065, 0.7480000257492065, 0.7450000047683716, 0.7480000257492065, 0.7450000047683716, 0.7419999837875366, 0.7419999837875366, 0.746999979019165, 0.746999979019165, 0.746999979019165, 0.7519999742507935, 0.7519999742507935, 0.7519999742507935, 0.753000020980835, 0.753000020980835, 0.753000020980835, 0.753000020980835, 0.7580000162124634, 0.7580000162124634, 0.753000020980835, 0.753000020980835, 0.75, 0.75, 0.7419999837875366, 0.7369999885559082, 0.718999981880188, 0.6579999923706055, 0.6179999709129333, 0.6060000061988831, 0.6060000061988831, 0.6060000061988831, 0.6069999933242798, 0.6119999885559082, 0.6119999885559082, 0.6079999804496765, 0.6079999804496765, 0.6119999885559082, 0.6100000143051147, 0.6119999885559082, 0.6119999885559082, 0.6100000143051147, 0.6050000190734863, 0.6050000190734863, 0.6050000190734863, 0.6050000190734863, 0.6079999804496765, 0.621999979019165, 0.625, 0.625, 0.6389999985694885, 0.6389999985694885, 0.6389999985694885, 0.6389999985694885, 0.6389999985694885, 0.6389999985694885, 0.6430000066757202, 0.6430000066757202, 0.6430000066757202, 0.6480000019073486, 0.6480000019073486, 0.6480000019073486, 0.6480000019073486, 0.6480000019073486, 0.6460000276565552, 0.6480000019073486, 0.6480000019073486, 0.6480000019073486, 0.6489999890327454, 0.6520000100135803, 0.6520000100135803, 0.6570000052452087, 0.6570000052452087, 0.6549999713897705, 0.6549999713897705, 0.656000018119812, 0.6549999713897705, 0.656000018119812)	
	
	datapoints = [(23.46712862681692, 16.315629826280528), (22.965178225221095, 15.518212982879019), (23.36139060860037, 14.663319085918962), (23.757602991979645, 13.808425188958905), (23.25565259038382, 13.011008345557395), (22.753702188787997, 12.213591502155884), (23.149914572167273, 11.358697605195827)]
	waypoints_x = []
	waypoints_y = []

	for point in datapoints:
		waypoints_x.append(point[0])
		waypoints_y.append(point[1])

	# Waypoints (insert generated-0.6172456030356905, 0.7867705291462732 or manual waypoints)
	#waypoints_x = (23.48882507592373,  23.006695546969706,23.423858986037278,23.84102242510485,23.358892896150824,22.876763367196798, 23.29392680626437)
	#waypoints_y = (16.329364782320145, 15.528191730487976,14.691351359343741, 13.854510988199506,13.053337936367335,12.252164884535166,11.415324513390932)

	for index in range(len(waypoints_x)):
		waypoints_x[index] = math.cos(pose_alpha) * waypoints_x[index] + waypoints_y[index] * -1 * math.sin(pose_alpha) - pose_x 
		waypoints_y[index] = math.sin(pose_alpha) * waypoints_x[index] + waypoints_y[index] * +1 * math.cos(pose_alpha) - pose_y

	# Variables
	datapoints_x = []
	datapoints_y = []
	
	# Calculate Plot Datapoints
	i = 0
	while i<len(ranges):
		
		# Skip inf values
		if ranges[i] < 99:		
			datapoints_x.append(math.cos(angle_min + increment * i) * ranges[i])
			datapoints_y.append(math.sin(angle_min + increment * i) * ranges[i])
			
		i += 1
		
	plt.plot(datapoints_x, datapoints_y, 'ro')
	plt.plot(waypoints_x, waypoints_y, 'g^')
	
	plt.show()
